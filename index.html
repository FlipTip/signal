<!DOCTYPE html>

<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="robots" content="noindex">
    

    <meta property="og:title" content="Make privacy stick with a new Signal sticker pack"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://signal.art/addstickers/"/>
    <meta property="og:image" content="https://signal.art//assets/og/sticker-preview-52ebe1345df82d5e67ed3f27861cf1e830cfb6a1c8bf822888fb0d45cdfa1f7c.png"/>

    <title>Install Signal stickers</title>

    <link rel="apple-touch-icon" sizes="57x57" href="/assets/favicon/apple-icon-57x57-1e56b07703490ebba4713a0b5ea25a03ae8d86eabc4a961158edf5b46590fd3d.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/favicon/apple-icon-60x60-e2db2d0761f2007f5d2b1f9594a5caa49705c1221ced2472a2e471e0c53ed3fa.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-icon-72x72-97b53da0f83cc83e78f550a175abc7655b655a4ff6f8969616ccf6a45431f823.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/favicon/apple-icon-76x76-9f2b2add20d8060fab5bda1a4fc4dbc23330e56b6ce846dc71af34b643b44294.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/favicon/apple-icon-114x114-f6319e407b9c5379fbb0753dbf272e8d3b24a0c2e107d3c971fa173f861580bc.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/favicon/apple-icon-120x120-c98504fda21e8555d8c527f46d170b182630953915e3f35e6be58ad7c2ba2016.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/favicon/apple-icon-144x144-6673d278a3a610c29c506b94db1c39dbaed7316a3daa8dfa84b115d9a17a3be1.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-icon-152x152-8d0419698314ff17820aa277bc5c56df4048fff96b89d021c5e3240c804c008d.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-icon-180x180-aa2761b8418076157d993fa209969b64f3ef435dcbefb20e7f9b4ad03e6e76bd.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/assets/favicon/android-icon-192x192-2ce7be93a7e75de13098e18298fcb8910772ec2e035cea23f3c2ad438ff8e504.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32-382989a29cc9004cc5b4b723098a5663f944b48d4694df252b89caa831fa205f.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon/favicon-96x96-aa38de7ff5098e6c9a3a41bd2424266d64b0200d347d682292c01a1d6d402660.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16-c6d9330e8b333a3ff4dd7d9ccbfccbb22265db57ba79fd8d3f9a31a90e7d4857.png">
    <link rel="preload" href="/assets/inter/Inter-Regular-c342b1b7f7d19be1429fef29bf3af6d9e8c3e21aba846e082cdee1db8a530c83.woff2" as="font" crossorigin="anonymous">
    <link rel="preload" href="/assets/inter/Inter-ExtraBold-74e72c6bbb7844899343c4783be9b4510e32951636acde44d5b4725e2132ea03.woff2" as="font" crossorigin="anonymous">
    <link rel="manifest" href="/assets/favicon/manifest-afc52691d6d2cefdcc79152af8efdf7848d5226b0daf713c2d6699c504fb3a75.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/assets/favicon/ms-icon-144x144-c87fa9bc9f7648a5dc55c8bb767caa2c9f3ff5d13dbdce9eb82e75e14ebe41d9.png">
    <meta name="theme-color" content="#ffffff">

    <link type="text/css" rel="stylesheet" href="/assets/vendor/bulma-0.8.0.min-ccf7949cbe2c285e72f3a5c936d8abba9270e77d27b2529804ff4738dda4944e.css">
    <link type="text/css" rel="stylesheet" href="/assets/ultramarine-2ff4c5d93cbc34c0a2f2e51c05658a2d2ddce95ab9ad26efebc875b46347b5ba.css">
  </head>

  <body id="signal" class="index has-navbar-fixed-top">
    <!-- Navigation -->
    <nav class="navbar signal-navbar is-fixed-top" role="navigation" aria-label="main navigation">
      <div class="container">
        <div class="navbar-brand">
          <a href="https://www.signal.org/#signal">
            <img class="signal-logo" src="/assets/header/logo-f7ef605fe417d5520d38d546b3b774b4261c75220b9904da4d8b2ffc19a761ff.png"/>
          </a>

          <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="signalNavbar">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>
        </div>

        <div id="signalNavbar" class="navbar-menu">
          <div class="navbar-end">
            <a class="navbar-item get-signal" href="https://www.signal.org/download/">Get Signal</a>
            <a class="navbar-item" href="https://support.signal.org">Support</a>
            <a class="navbar-item" href="https://www.signal.org/blog/">Blog</a>
            <a class="navbar-item" href="https://www.signal.org/docs/">Developers</a>
            <a class="navbar-item" href="https://www.signal.org/workworkwork/">Careers</a>
            <a class="navbar-item" href="https://www.signal.org/donate/">Donate</a>
            <a class="navbar-item" href="https://twitter.com/signalapp" target="_blank"><i class="icon icon-twitter"></i></a>
            <a class="navbar-item" href="https://instagram.com/signal_app/" target="_blank"><i class="icon icon-instagram"></i></a>

            
          </div>
        </div>
      </div>
    </nav>

    <div class="main">
      <section id="addstickers" class="section stickers">
  <div class="columns is-centered has-text-centered">
    <div class="column is-4">
      <img src="/assets/sticker_phone-da289374db6004f34c3a5a1254faf2b11c3bb3e40b424b68f71028189db6e03a.png"/>
      <p></p>
      <div id="target">
        <p class="stickers">
          A <b>Signal</b> user has created this sticker pack.
        </p>
      </div>
      <script id="template" type="x-tmpl-mustache">
        <p class="stickers">
          
	          Add <b>{{title}}</b>, a sticker pack created by <b>{{author}}</b> for Signal.
          
        </p>
      </script>


      <div id="add-stickers-button">
        <button class="button button-large" style="margin: 24px 0">
          <a href="" id="add-sticker-link" class="no-underline">ADD STICKERS</a>
        </button>
      </div>

      <p class="stickers">
	      Don't have Signal? <a href="https://signal.org/download/"/>Get it here</a>
      </p>
    </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/gh/dcodeIO/protobuf.js@6.8.8/dist/protobuf.min.js" integrity="sha384-5dStEkuAXC5qJwZ7qXJyPslZhTKvpzs3my5U4jIjrbl/PYn3w8kilaCpCOHBSAmq" crossorigin="anonymous"></script>
<script type="text/javascript" src="/assets/mustache-89aa9f3b9b9ed156d219c122427f8e797c67c4030adbe4201d72030396d6b462.js"></script>

<script>
  function processManifest() {
    if (!window.location.hash) {
      document.getElementById('target').innerHTML = "No sticker pack found.";
      document.getElementById('add-stickers-button').innerHTML = '';
      return;
    }

    var params   = parseParameters(window.location.hash.substr(1));
    var redirect = "sgnl://addstickers/?pack_id=" + params['pack_id'] + "&pack_key=" + params['pack_key'];
    document.getElementById('add-sticker-link').href = redirect;
    window.location = redirect;

    var xhr = new XMLHttpRequest();
    xhr.open('GET', "https://cdn-ca.signal.org/stickers/" + params['pack_id'] + "/manifest.proto", true);
    xhr.responseType = 'arraybuffer';

    xhr.onload = function(oEvent) {
      if (this.status == 200) {
        decryptManifest(params['pack_key'], new Uint8Array(xhr.response)).then(manifest => {
          parseManifest(manifest).then(data => {
            var template = document.getElementById('template').innerHTML;
            var rendered = Mustache.render(template, data);
            document.getElementById('target').innerHTML = rendered;
          });
        }).catch(error => {
          console.log(error.stack);
          alert("Error: " + error);
        });
      }
    };

    xhr.send();
  }

  function parseManifest(manifest) {
    return protobuf.load("Stickers.proto")
                   .then(function(root) {
                     var manifestData = new Uint8Array(manifest, 0, manifest.byteLength);
                     var PackMessage = root.lookupType("Pack");
                     var pack        = PackMessage.decode(manifestData);
                     return pack;
                   });
  }

  async function decryptManifest(encodedKey, encryptedManifest) {
    var keys               = await deriveKeys(encodedKey);
    var theirIv            = encryptedManifest.slice(0, 16);
    var ciphertextBody     = encryptedManifest.slice(16, encryptedManifest.byteLength - 32);
    var theirMac           = encryptedManifest.slice(encryptedManifest.byteLength - 32, encryptedManifest.byteLength);
    var combinedCiphertext = encryptedManifest.slice(0, encryptedManifest.byteLength - 32);

    var macKey = await window.crypto.subtle.importKey("raw",
                                                      keys[1],
                                                      { name : "HMAC",
                                                        hash : { name : "SHA-256" }
                                                      },
                                                      false,
                                                      ["verify", "sign"]);

    var ourMac = await window.crypto.subtle.sign({name : "HMAC"}, macKey, combinedCiphertext);


    var valid = await window.crypto.subtle.verify({name : "HMAC"},
                                                  macKey,
                                                  theirMac,
                                                  combinedCiphertext);

    if (valid) {
      var cipherKey = await window.crypto.subtle.importKey("raw",
                                                           keys[0],
                                                           { name : "AES-CBC" },
                                                           false,
                                                           ["decrypt"]);

      var plaintext = await window.crypto.subtle.decrypt({name : "AES-CBC", iv : theirIv},
                                                         cipherKey,
                                                         ciphertextBody);


      return plaintext;
    } else {
      throw new Error('MAC failed');
    }
  }

  async function deriveKeys(encodedKey) {
    var masterKey = await window.crypto.subtle.importKey("raw",
                                                         hexToArrayBuffer(encodedKey),
                                                         'HKDF',
                                                         false,
                                                         ['deriveKey']);

    var derivedKeys = await window.crypto.subtle.deriveKey({name : "HKDF",
                                                            hash : "SHA-256",
                                                            salt : new ArrayBuffer(32),
                                                            info : new TextEncoder().encode("Sticker Pack")},
                                                           masterKey,
                                                           {name : "HMAC",
                                                            hash : "SHA-256",
                                                            length : 512},
                                                           true,
                                                           ["verify"]);

    var derivedKeyBytes = await window.crypto.subtle.exportKey("raw", derivedKeys);

    return [derivedKeyBytes.slice(0, 32), derivedKeyBytes.slice(32, 64)];
  }

  function parseParameters(hash) {
    var params = {};

    hash.split("&").forEach(function(item) {
    var parts = item.split("=");
      if (parts.length == 2) {
        params[parts[0]] = parts[1];
      }
    });

    return params;
  }

  function hexToArrayBuffer (hexString) {
    var result = [];
    while (hexString.length >= 2) {
      result.push(parseInt(hexString.substring(0, 2), 16));
      hexString = hexString.substring(2, hexString.length);
    }
    return new Uint8Array(result);
  }

  window.onload = processManifest;
</script>

    </div>

    <footer class="footer">
      <div class="container">
        <div class="columns">
          <div class="column is-two-fifths is-hidden-mobile">
            <span class="copyright">&copy; 2013&ndash;2021 Signal, a 501c3 nonprofit.</span><br />
            Signal is a registered trademark in the United States and other countries.
            <br />
            <br />
            For media inquiries, contact <a href="mailto:press@signal.org">press@signal.org</a>
          </div>

          <div class="column">
            <strong>Company</strong>

            <ul>
              <li>
                <a href="https://www.signal.org/donate/">Donate</a>
              </li>
              <li>
                <a href="https://www.signal.org/workworkwork/">Careers</a>
              </li>
              <li>
                <a href="https://www.signal.org/blog/">Blog</a>
              </li>
              <li>
                <a href="https://www.signal.org/legal/">Terms &amp; Privacy Policy</a>
              </li>
            </ul>
          </div>

          <div class="column">
            <strong>Download</strong>

            <ul>
              <li>
                <a href="https://www.signal.org/download/android">Android</a>
              </li>
              <li>
                <a href="https://www.signal.org/download/ios">iPhone & iPad</a>
              </li>
              <li>
                <a href="https://www.signal.org/download/windows">Windows</a>
              </li>
              <li>
                <a href="https://www.signal.org/download/macos">Mac</a>
              </li>
              <li>
                <a href="https://www.signal.org/download/linux">Linux</a>
              </li>
            </ul>
          </div>

          <div class="column">
            <strong>Social</strong>

            <ul>
              <li>
                <a href="https://github.com/signalapp" target="_blank">Github</a>
              </li>
              <li>
                <a href="https://twitter.com/signalapp" target="_blank">Twitter</a>
              </li>
              <li>
                <a href="https://www.instagram.com/signal_app/" target="_blank">Instagram</a>
              </li>
            </ul>
          </div>

          <div class="column">
            <strong>Help</strong>

            <ul>
              <li>
                <a href="https://support.signal.org/">Support</a>
              </li>
              <li>
                <a href="https://community.signalusers.org/">Community</a>
              </li>
            </ul>
          </div>

          <div class="column is-two-fifths is-hidden-tablet">
            <span class="copyright">&copy; 2013&ndash;2021 Signal, a 501c3 nonprofit.</span><br />
            Signal is a registered trademark in the United States and other countries.
            <br />
            <br />
            For media inquiries, contact <a href="mailto:press@signal.org">press@signal.org</a>
          </div>

        </div>
      </div>
    </footer>

<script type="text/javascript">
  const $langSelectors = Array.prototype.slice.call(document.querySelectorAll('a[data-lang]'));

  $langSelectors.forEach((el) => {
    el.addEventListener('click', (ev) => {
      const lang = ev.getAttribute('data-lang');

      if (lang) {
        document.cookie = 'selected_language=' + lang + '; samesite; secure; path=/; max-age=7776000;';
      }
    });
  });

  document.addEventListener('DOMContentLoaded', () => {
    var userAgent = navigator.userAgent.toLowerCase();

    var isIOS = (
      userAgent.indexOf('iphone') !== -1 ||
      userAgent.indexOf('ipad') !== -1 ||
      userAgent.indexOf('ipod') !== -1
    );
    var isAndroid = userAgent.indexOf('android') !== -1;
    var $downloadSignal = document.querySelectorAll('.get-signal');

    if (isIOS || isAndroid) {
      var url = isIOS
        ? 'https://apps.apple.com/us/app/signal-private-messenger/id874139669'
        : 'https://play.google.com/store/apps/details?id=org.thoughtcrime.securesms';

      Array.prototype.slice.call($downloadSignal).forEach(($downloadSignalNode) => {
        $downloadSignalNode.href = url;
        $downloadSignalNode.innerHTML = '<span>Get Signal</span> <i class="icon icon-external-link-alt"></i>';
      });
    }

    const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'));

    if ($navbarBurgers.length > 0) {
      $navbarBurgers.forEach((el) => {
        el.addEventListener('click', () => {
          const target = el.dataset.target;
          const $target = document.getElementById(target);
          el.classList.toggle('is-active');
          $target.classList.toggle('is-active');
        });
      });
    }
  });
</script>

  </body>
</html>
